// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Customer {
  id              String     @id @default(uuid())
  code            String     @unique @default("")  // Auto-generated 7-digit code
  companyNameEn   String
  companyNameTh   String
  shortName       String?
  addressEn       String
  addressTh       String
  mailingAddress  String?
  taxId           String     @unique  // Layer 1: Unique constraint
  bankName        String?
  bankBranch      String?
  bankAccount     String?
  bankBranchCode  String?
  createdAt       BigInt     @default(0)
  isActive        Boolean    @default(true)
  
  @@index([taxId])
  @@index([code])
  @@index([companyNameEn])
  @@index([companyNameTh])
}


model CompanyInfo {
  id             Int    @id @default(1)
  nameEn         String @default("")
  nameTh         String @default("")
  addressEn      String @default("")
  addressTh      String @default("")
  taxId          String @default("")
  bankName       String @default("")
  bankAccountThb String @default("")
  bankAccountUsd String @default("")
  bankAddress    String @default("")
  swiftCode      String @default("")
}

model SupplierType {
  id        Int        @id @default(autoincrement())
  nameZh    String     @unique
  nameEn    String     @unique
  suppliers Supplier[]
}

model Supplier {
  id              String   @id @default(uuid())
  code            String   @unique @default("")  // Auto-generated 7-digit code
  
  // Common fields
  entityType      String   // 'company' or 'individual'
  supplierTypeId  Int
  shortName       String?
  
  // Individual-specific fields
  fullName        String?
  taxIdIndividual String?
  addressIndividual String?
  
  // Company-specific fields
  companyNameEn   String?
  companyNameTh   String?
  taxIdCompany    String?  @unique
  addressEn       String?
  addressTh       String?
  branchCode      String?
  
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  // Relations
  supplierType    SupplierType @relation(fields: [supplierTypeId], references: [id])
  bankAccounts    BankAccount[]
  
  @@index([supplierTypeId])
  @@index([code])
  @@index([entityType])
  @@index([companyNameEn])
  @@index([fullName])
}

model BankAccount {
  id          String   @id @default(uuid())
  supplierId  String
  
  bankName    String
  accountNo   String
  currency    String   // 'THB', 'USD', 'CNY', etc.
  bankAddress String?
  branchCode  String?
  
  createdAt   DateTime @default(now())
  
  // Relations
  supplier    Supplier @relation(fields: [supplierId], references: [id], onDelete: Cascade)
  
  @@index([supplierId])
  @@index([currency])
}

model TransportType {
  id        Int        @id @default(autoincrement())
  nameZh    String     @unique
  nameEn    String     @unique
}

model BusinessType {
  id        Int        @id @default(autoincrement())
  nameZh    String     @unique
  nameEn    String     @unique
}

model TradeTerms {
  id     Int    @id @default(autoincrement())
  nameZh String @unique
  nameEn String @unique
}

model LoadingMethod {
  id        Int        @id @default(autoincrement())
  nameZh    String     @unique
  nameEn    String     @unique
}


model Port {
  id          String   @id @default(uuid())
  code        String   @unique  // International port code, e.g., CNSHA, THBKK
  nameEn      String              // English name
  nameCn      String              // Chinese name
  country     String              // Country code, e.g., CN, TH, US
  countryName String              // Country name
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@index([code])
  @@index([nameEn])
  @@index([country])
}





model FinancialSubject {
  id        Int      @id @default(autoincrement())
  nameZh    String   @unique
  nameEn    String   @unique
}
