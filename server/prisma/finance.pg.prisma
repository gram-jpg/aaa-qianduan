generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/@prisma/finance-pg-client"
}

datasource db {
  provider = "postgresql"
  url      = env("FINANCE_DATABASE_URL_PG")
}

model ShipmentCost {
  id                String   @id @default(uuid())
  shipmentId        String
  description       String
  amount            Float
  currency          String   @default("THB")
  type              String
  financialSubjectId Int
  settlementUnitType String
  settlementUnitId   String
  vatRate           Decimal  @default(7.0)
  whtRate           Decimal  @default(3.0)
  remarks           String?
  applicationNumber String?
  applicationDate   DateTime?
  dueDate           DateTime?
  applicationRemarks String?
  status            String   @default("unapplied")
  invoiceId         String?
  settlementDate    DateTime?
  settlementRemarks String?
  createdBy         String?
  createdAt         DateTime @default(now())

  @@index([shipmentId])
  @@index([status])
  @@index([applicationNumber])
  @@index([type])
  @@index([financialSubjectId])
}

model Invoice {
  id          String   @id @default(uuid())
  number      String   @unique
  shipmentId  String
  type        String
  totalAmount Float
  currency    String
  status      String   @default("draft")
  issueDate   DateTime
  dueDate     DateTime?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([shipmentId])
  @@index([number])
}

model ExpenseApplication {
  id                String   @id @default(uuid())
  applicationNumber String   @unique
  type              String
  totalAmount       Float
  currency          String
  costCount         Int
  dueDate           DateTime?
  remarks           String?
  status            String   @default("active")
  createdBy         String?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  canceledAt        DateTime?

  @@index([applicationNumber])
  @@index([type])
  @@index([status])
  @@index([createdAt])
}
